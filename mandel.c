/* Praktikum Maschinenorientiertes Programmieren - Vorlage Versuch 4 von D. Pawelczak */
#ifdef MOPVM
#include <sdlite.h>
#else
#include <SDL/sdl.h>
#endif

#define SIZE_X 320
#define SIZE_Y 240
#define MAX_ITERATION 128
#define BIT_DEPTH 32

typedef struct{
	unsigned char blue; 
	unsigned char green;
	unsigned char red;
	unsigned char alpha;
} tColor;

void PutPixel(unsigned char* videoRam, int x, int y, const tColor *c);
void FillScreen(unsigned char* videoRam, const tColor *c);

/* ToDo: define tColor */
const tColor gColorList[] = 
{ 	
	{ 0x10, 0x00, 0x00, 0xFF }, { 0x20, 0x00, 0x00, 0xFF }, { 0x30, 0x00, 0x00, 0xFF }, { 0x40, 0x00, 0x00, 0xFF }, { 0x50, 0x00, 0x00, 0xFF }, { 0x60, 0x00, 0x00, 0xFF }, { 0x70, 0x00, 0x00, 0xFF }, { 0x80, 0x00, 0x00, 0xFF },
	{ 0x90, 0x00, 0x00, 0xFF }, { 0xad, 0x00, 0x00, 0xFF }, { 0xb0, 0x00, 0x00, 0xFF }, { 0xc0, 0x00, 0x00, 0xFF }, { 0xd0, 0x00, 0x00, 0xFF }, { 0xe0, 0x00, 0x00, 0xFF }, { 0xf0, 0x00, 0x00, 0xFF }, { 0xff, 0x00, 0x00, 0xFF },
	{ 0xff, 0x10, 0x10, 0xFF }, { 0xff, 0x20, 0x20, 0xFF }, { 0xff, 0x30, 0x30, 0xFF }, { 0xff, 0x40, 0x40, 0xFF }, { 0xff, 0x50, 0x50, 0xFF }, { 0xff, 0x60, 0x60, 0xFF }, { 0xff, 0x70, 0x70, 0xFF }, { 0xff, 0x80, 0x80, 0xFF },
	{ 0xff, 0x90, 0x80, 0xFF }, { 0xff, 0xa0, 0x80, 0xFF }, { 0xff, 0xb0, 0x80, 0xFF }, { 0xff, 0xc0, 0x80, 0xFF }, { 0xff, 0xd0, 0x80, 0xFF }, { 0xff, 0xe0, 0x80, 0xFF }, { 0xff, 0xf0, 0x80, 0xFF }, { 0xff, 0xff, 0x80, 0xFF },
	{ 0xf0, 0xff, 0x80, 0xFF }, { 0xe0, 0xff, 0x80, 0xFF }, { 0xd0, 0xff, 0x80, 0xFF }, { 0xc0, 0xff, 0x80, 0xFF }, { 0xb0, 0xff, 0x80, 0xFF }, { 0xa0, 0xff, 0x80, 0xFF }, { 0x90, 0xff, 0x80, 0xFF }, { 0x80, 0xff, 0x80, 0xFF },
	{ 0x80, 0xff, 0x80, 0xFF }, { 0x70, 0xff, 0x70, 0xFF }, { 0x60, 0xff, 0x60, 0xFF }, { 0x50, 0xff, 0x50, 0xFF }, { 0x40, 0xff, 0x40, 0xFF }, { 0x30, 0xff, 0x30, 0xFF }, { 0x20, 0xff, 0x20, 0xFF }, { 0x10, 0xff, 0x10, 0xFF },
	{ 0x00, 0xf0, 0x00, 0xFF }, { 0x00, 0xe0, 0x00, 0xFF }, { 0x00, 0xd0, 0x00, 0xFF }, { 0x00, 0xc0, 0x00, 0xFF }, { 0x00, 0xb0, 0x00, 0xFF }, { 0x00, 0xa0, 0x00, 0xFF }, { 0x00, 0x90, 0x00, 0xFF }, { 0x00, 0x80, 0x00, 0xFF },
	{ 0x00, 0x80, 0x10, 0xFF }, { 0x00, 0x80, 0x20, 0xFF }, { 0x00, 0x80, 0x30, 0xFF }, { 0x00, 0x80, 0x40, 0xFF }, { 0x10, 0x80, 0x50, 0xFF }, { 0x20, 0x80, 0x60, 0xFF }, { 0x30, 0x80, 0x70, 0xFF }, { 0x40, 0x80, 0x80, 0xFF },
	{ 0x40, 0x90, 0x90, 0xFF }, { 0x50, 0xa0, 0xa0, 0xFF }, { 0x60, 0xb0, 0xb0, 0xFF }, { 0x60, 0xc0, 0xc0, 0xFF }, { 0x70, 0xd0, 0xd0, 0xFF }, { 0x70, 0xe0, 0xe0, 0xFF }, { 0x70, 0xf0, 0xf0, 0xFF }, { 0x70, 0xff, 0xff, 0xFF },
	{ 0x80, 0xff, 0xff, 0xFF }, { 0x80, 0xf0, 0xff, 0xFF }, { 0x80, 0xd0, 0xff, 0xFF }, { 0x80, 0xc0, 0xff, 0xFF }, { 0x80, 0xb0, 0xff, 0xFF }, { 0x80, 0xa0, 0xff, 0xFF }, { 0x80, 0x90, 0xff, 0xFF }, { 0x80, 0x80, 0xff, 0xFF }, 
	{ 0x70, 0x70, 0xff, 0xFF }, { 0x60, 0x60, 0xff, 0xFF }, { 0x50, 0x50, 0xff, 0xFF }, { 0x40, 0x40, 0xff, 0xFF }, { 0x30, 0x30, 0xff, 0xFF }, { 0x20, 0x20, 0xff, 0xFF }, { 0x10, 0x10, 0xff, 0xFF }, { 0x00, 0x00, 0xff, 0xFF }, 
	{ 0x00, 0x00, 0xf0, 0xFF }, { 0x00, 0x00, 0xe0, 0xFF }, { 0x00, 0x00, 0xd0, 0xFF }, { 0x00, 0x00, 0xc0, 0xFF }, { 0x00, 0x00, 0xb0, 0xFF }, { 0x00, 0x00, 0xa0, 0xFF }, { 0x00, 0x00, 0x90, 0xFF }, { 0x00, 0x00, 0x80, 0xFF }, 
	{ 0x10, 0x00, 0x80, 0xFF }, { 0x20, 0x00, 0x80, 0xFF }, { 0x30, 0x00, 0x80, 0xFF }, { 0x40, 0x00, 0x80, 0xFF }, { 0x50, 0x00, 0x80, 0xFF }, { 0x60, 0x00, 0x80, 0xFF }, { 0x70, 0x00, 0x80, 0xFF }, { 0x80, 0x00, 0x80, 0xFF }, 
	{ 0x80, 0x10, 0x80, 0xFF }, { 0x90, 0x10, 0x80, 0xFF }, { 0xa0, 0x10, 0x90, 0xFF }, { 0xb0, 0x10, 0xa0, 0xFF }, { 0xc0, 0x10, 0xa0, 0xFF }, { 0xd0, 0x10, 0xb0, 0xFF }, { 0xe0, 0x20, 0xc0, 0xFF }, { 0xf0, 0x20, 0xd0, 0xFF }, 
	{ 0xff, 0x20, 0xf0, 0xFF }, { 0xff, 0x30, 0xf0, 0xFF }, { 0xff, 0x40, 0xf0, 0xFF }, { 0xff, 0x50, 0xe0, 0xFF }, { 0xff, 0x60, 0xd0, 0xFF }, { 0xff, 0x70, 0xc0, 0xFF }, { 0xff, 0x80, 0xb0, 0xFF }, { 0xff, 0x90, 0xa0, 0xFF }, 
	{ 0xff, 0x80, 0x90, 0xFF }, { 0xff, 0x90, 0x80, 0xFF }, { 0xff, 0xa0, 0x80, 0xFF }, { 0xff, 0xb0, 0x80, 0xFF }, { 0xff, 0xc0, 0x80, 0xFF }, { 0xff, 0xd0, 0x80, 0xFF }, { 0xff, 0xe0, 0x80, 0xFF }, { 0xff, 0xf0, 0x80, 0xFF },   
	{ 0x00, 0x00, 0x00, 0xFF }
};

int main(int argc, char** argv) {
	
	tColor sandyBrown = { .blue = 0x60, 
		.green = 0xA4, .red = 0xF4, .alpha = 0xFF};
	
	unsigned char* videoRam = NULL;
	SDL_Surface *screen = NULL;

	if (SDL_Init(SDL_INIT_VIDEO) != 0)
		return 1;
    screen = SDL_SetVideoMode(SIZE_X, SIZE_Y, BIT_DEPTH, 0);
    if (screen == NULL)
        return 2;
	/* the ptr to video memory */
	videoRam = screen->pixels;
	PutPixel(videoRam, 50, 50, &sandyBrown);
	FillScreen(videoRam, &sandyBrown);
	printf("%i", videoRam[0]);
	printf("\n%i", videoRam[1]);
	printf("\n%i", videoRam[2]);
	printf("\n%i", videoRam[3]);
	/* Todo */
	SDL_Flip(screen);
	return 0;
}

void PutPixel(unsigned char* videoRam, int x, int y, const tColor *c) {
	if(x >= 0 && x < SIZE_Y * 4){
		x = x * 4;
		if(y >= 0 && y < SIZE_Y){
			if(y > 0){
				for(y;y>0;y--){
					x+=1280;
				}
			}
			videoRam[x] = c->blue;
			videoRam[x + 1] = c->green;
			videoRam[x + 2] = c->red;
			videoRam[x + 3] = c->alpha;
		}
	}
}

void FillScreen(unsigned char* videoRam, const tColor *c) {
	int y = 0;
	int x = 0;
	while(x < SIZE_X) {
		y = 0;
		while(y < SIZE_Y){
			PutPixel(videoRam, x, y, c);
			y++;
		}
		x++;
	}
}